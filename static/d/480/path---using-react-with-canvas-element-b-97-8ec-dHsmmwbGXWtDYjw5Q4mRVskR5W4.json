{"data":{"logo":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABFUlEQVQY023PvUrDUBTA8ZuCtoMoOLQ4dWhN14x2kEKXFkGoohQ/QBexOHRycAidKkgHHRq69APRoTjFJYODIA6+gSBYfYMmfYLE/5VT6NALP845NyeHc9UoCHZRQvonCLKKE4ZhAXYURTsYoE9dIy5iCzfUJnEdV+RF4iu6ikFH2EPxazzOcJmg4Rnn5C8ysIEOHqTe5/sT3qXOwYOtRr5/wLAqzpCTDXu4p2ETtyjgGJ/cX+se8jeU9fa4RBt5vWENpjzdkoGPcGg4RQsbOMEFmnBRRwVDHEK/yFXfvr/CoPjvZLKcdByDyzWGeajigzorGy0oOeRJiUtITe/pX1XzDk3buIMltSFR/zTtic3060X+8z8PsEUt8G3LVQAAAABJRU5ErkJggg==","width":400,"height":128,"src":"/static/ghost-logo-2b5eaa0de166a8b5faebad4955c2200c-51380.png","srcSet":"/static/ghost-logo-2b5eaa0de166a8b5faebad4955c2200c-51380.png 1x"}}},"markdownRemark":{"html":"<h1>How to use React with canvas element?</h1>\n<p>We have React that helps us to work with massive mutable DOM in a nice immutable functional style. That is awesome.</p>\n<p>But I would like to describe a way of using React that helps you to work with mutable object representation of “immutable” <code class=\"language-text\">&lt;canvas&gt;</code> element. Yes, it sounds strange. But it works really well.</p>\n<h2>Motivation</h2>\n<p>I am using <code class=\"language-text\">&lt;canvas&gt;</code> element a lot. I made several complex applications which use <code class=\"language-text\">&lt;canvas&gt;</code> as a main view component. Vanilla canvas without any frameworks/libraries can be really difficult for complex applications. So I started to use canvas frameworks a lot. Now I maintain <a href=\"https://konvajs.github.io/\">Konva 2d canvas Framework</a>.</p>\n<p><code class=\"language-text\">Konva</code> helps a lot, but still now not so good, as I wanted. Also I started to use React in my applications and I really like to use it. So I was thinking how can I use React for drawing graphics on canvas.</p>\n<p>Native canvas inside React\nIt is very easy to access <canvas> context in React component and draw any graphics:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CanvasComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">updateCanvas</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">updateCanvas</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>refs<span class=\"token punctuation\">.</span>canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2d'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n            <span class=\"token operator\">&lt;</span>canvas ref<span class=\"token operator\">=</span><span class=\"token string\">\"canvas\"</span> width<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">300</span><span class=\"token punctuation\">}</span> height<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">300</span><span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\nReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>CanvasComponent<span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'container'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Demo: <a href=\"http://jsbin.com/xituko/edit?js,output\">http://jsbin.com/xituko/edit?js,output</a></p>\n<p>It works nice for trivial examples. But for complex applications this approach is not so good because we can not use full power of reusable React components.</p>\n<p>// “reusable component”\nfunction rect(props) {\nconst {ctx, x, y, width, height} = props;\nctx.fillRect(x, y, width, height);\n}\nclass CanvasComponent extends React.Component {\ncomponentDidMount() {\nthis.updateCanvas();\n}\ncomponentDidUpdate() {\nthis.updateCanvas();\n}\nupdateCanvas() {\nconst ctx = this.refs.canvas.getContext(‘2d’);\nctx.clearRect(0,0, 300, 300);\n// draw children “components”\nrect({ctx, x: 10, y: 10, width: 50, height: 50});\nrect({ctx, x: 110, y: 110, width: 50, height: 50});\n}\nrender() {\nreturn (\n<canvas ref=\"canvas\" width={300} height={300}/>\n);\n}\n}\nReactDOM.render(<CanvasComponent/>, document.getElementById(‘container’));\nAnd what about React’s lifecycle methods (like shouldComponentUpdate etc) and “all representation inside render function”?</p>\n<p>Implementation\nI really like React approach for building apps. So I made react binding to Konva objects. And now I can draw canvas stage with different graphic shapes and use it in my React application.</p>\n<p>npm install react konva react-konva —save\nThen</p>\n<p>import React from ‘react’;\nimport ReactDOM from ‘react-dom’;\nimport {Layer, Rect, Stage, Group} from ‘react-konva’;</p>\n<p>class MyRect extends React.Component {\nconstructor(…args) {\nsuper(…args);\nthis.state = {\ncolor: ‘green’\n};\nthis.handleClick = this.handleClick.bind(this);\n}\nhandleClick() {\nthis.setState({\ncolor: Konva.Util.getRandomColor()\n});\n}\nrender() {\nreturn (\n<Rect\n                x={10} y={10} width={50} height={50}\n                fill={this.state.color}\n                shadowBlur={10}\n                onClick={this.handleClick}\n            />\n);\n}\n}\nfunction App() {\nreturn (\n<Stage width={700} height={700}>\n<Layer>\n<MyRect/>\n</Layer>\n</Stage>\n);\n}\nReactDOM.render(<App/>, document.getElementById(‘container’));\nDemo: <a href=\"http://jsbin.com/camene/8/edit?html,js,output\">http://jsbin.com/camene/8/edit?html,js,output</a></p>\n<p>Thanks <a href=\"https://github.com/reactjs/react-art\">https://github.com/reactjs/react-art</a> for providing good examples of custom React components.</p>\n<p>Comparisons\nreact-konva vs react-canvas\nreact-canvas is a completely different react plugin. It allows you to draw DOM-like objects (images, texts) on canvas element in very performant way. It is NOT about drawing graphics, but react-konva is exactly for drawing complex graphics on <canvas> element from React.</p>\n<p>react-konva vs react-art\nreact-art allows you to draw graphics on a page. It also supports SVG for output. But it has no support of events of shapes.</p>\n<p>react-konva vs vanilla canvas\nPerformance is one of the main buzz word in react hype.</p>\n<p>I made this plugin not for performance reasons. Using vanilla <canvas> should be more performant because while using react-konva you have Konva framework on top of <canvas> and React on top of Konva. But I made this plugin to fight with application complexity. Konva helps here a lot (especially when you need events for objects on canvas, like “click” on shape, it is really hard to do with vanilla canvas). But React helps here much more as it provides very good structure for your codebase and data flow.</p>\n<p>Features</p>\n<p>react-konva logo\nreact-konva works on top of Konva so it has support for all core shapes: Circle, Rect, Ellipse, Line, Sprite, Image, Text, TextPath, Star, Ring, Arc, Label, SVG Path, RegularPolygon, Arrow and you can create your own custom shapes. Also you can use build in drag&#x26;drop support, tweening, animations, filters, caching system, desktop and mobile events (mouseenter, click, dblclick, dragstart, dragmove, dragend, tap, dbltap, etc) and much more.</p>\n<p>Custom shape example\n// custom shape example\nfunction MyShape() {\nreturn (\n&#x3C;Shape fill=”#00D2FF” draggable\nsceneFunc={function (ctx) {\nctx.beginPath();\nctx.moveTo(20, 50);\nctx.lineTo(220, 80);\nctx.quadraticCurveTo(150, 100, 260, 170);\nctx.closePath();\n// Konva specific method\nctx.fillStrokeShape(this);\n}}\n/>\n);\n}\nDemo: <a href=\"http://jsbin.com/gakadi/4/edit?html,js,output\">http://jsbin.com/gakadi/4/edit?html,js,output</a></p>\n<p>Events example\nclass MyCircle extends React.Component {\nconstructor(…args) {\nsuper(…args);\nthis.state = { isMouseInside: false};\nthis.handleMouseEnter = this.handleMouseEnter.bind(this);\nthis.handleMouseLeave = this.handleMouseLeave.bind(this);\n}\nhandleMouseEnter() {\nthis.setState({ isMouseInside: true});\n}\nhandleMouseLeave() {\nthis.setState({ isMouseInside: false});\n}\nrender() {\nreturn (\n&#x3C;Circle\nx={100} y={60} radius={50}\nfill=”yellow” stroke=”black”\nstrokeWidth={this.state.isMouseInside ? 5 : 1}\nonMouseEnter={this.handleMouseEnter}\nonMouseLeave={this.handleMouseLeave}\n/>\n);\n}\n}\nDemo: <a href=\"http://jsbin.com/tekopu/3/edit?js,output\">http://jsbin.com/tekopu/3/edit?js,output</a></p>\n<p>Links\nGithub repo: <a href=\"https://github.com/lavrton/react-konva\">https://github.com/lavrton/react-konva</a></p>\n<p>Konva framework: <a href=\"http://konvajs.github.io/\">http://konvajs.github.io/</a></p>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"How to use React with canvas element?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We have React that helps us to work with massive mutable DOM in a nice immutable functional style. That is awesome."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"But I would like to describe a way of using React that helps you to work with mutable object representation of “immutable” "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"<canvas>"}]},{"type":"text","value":" element. Yes, it sounds strange. But it works really well."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Motivation"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"I am using "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"<canvas>"}]},{"type":"text","value":" element a lot. I made several complex applications which use "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"<canvas>"}]},{"type":"text","value":" as a main view component. Vanilla canvas without any frameworks/libraries can be really difficult for complex applications. So I started to use canvas frameworks a lot. Now I maintain "},{"type":"element","tagName":"a","properties":{"href":"https://konvajs.github.io/"},"children":[{"type":"text","value":"Konva 2d canvas Framework"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Konva"}]},{"type":"text","value":" helps a lot, but still now not so good, as I wanted. Also I started to use React in my applications and I really like to use it. So I was thinking how can I use React for drawing graphics on canvas."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Native canvas inside React\nIt is very easy to access "},{"type":"element","tagName":"canvas","properties":{},"children":[{"type":"text","value":" context in React component and draw any graphics:"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"javascript"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-javascript"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-javascript"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"CanvasComponent"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"extends"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"React"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"Component"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"componentDidMount"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"updateCanvas"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"updateCanvas"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"const"}]},{"type":"text","value":" ctx "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"refs"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"canvas"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"getContext"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'2d'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        ctx"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"fillRect"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"100"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"100"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"render"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"\n            "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"canvas ref"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"canvas\""}]},{"type":"text","value":" width"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"300"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":" height"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"300"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"/"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\nReactDOM"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"render"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"CanvasComponent"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"/"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" document"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"getElementById"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"'container'"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Demo: "},{"type":"element","tagName":"a","properties":{"href":"http://jsbin.com/xituko/edit?js,output"},"children":[{"type":"text","value":"http://jsbin.com/xituko/edit?js,output"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"It works nice for trivial examples. But for complex applications this approach is not so good because we can not use full power of reusable React components."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"// “reusable component”\nfunction rect(props) {\nconst {ctx, x, y, width, height} = props;\nctx.fillRect(x, y, width, height);\n}\nclass CanvasComponent extends React.Component {\ncomponentDidMount() {\nthis.updateCanvas();\n}\ncomponentDidUpdate() {\nthis.updateCanvas();\n}\nupdateCanvas() {\nconst ctx = this.refs.canvas.getContext(‘2d’);\nctx.clearRect(0,0, 300, 300);\n// draw children “components”\nrect({ctx, x: 10, y: 10, width: 50, height: 50});\nrect({ctx, x: 110, y: 110, width: 50, height: 50});\n}\nrender() {\nreturn (\n"},{"type":"element","tagName":"canvas","properties":{"ref":"canvas","width":"{300}","height":"{300}/"},"children":[{"type":"text","value":"\n);\n}\n}\nReactDOM.render("},{"type":"element","tagName":"canvascomponent","properties":{},"children":[{"type":"text","value":", document.getElementById(‘container’));\nAnd what about React’s lifecycle methods (like shouldComponentUpdate etc) and “all representation inside render function”?"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Implementation\nI really like React approach for building apps. So I made react binding to Konva objects. And now I can draw canvas stage with different graphic shapes and use it in my React application."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"npm install react konva react-konva —save\nThen"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"import React from ‘react’;\nimport ReactDOM from ‘react-dom’;\nimport {Layer, Rect, Stage, Group} from ‘react-konva’;"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"class MyRect extends React.Component {\nconstructor(…args) {\nsuper(…args);\nthis.state = {\ncolor: ‘green’\n};\nthis.handleClick = this.handleClick.bind(this);\n}\nhandleClick() {\nthis.setState({\ncolor: Konva.Util.getRandomColor()\n});\n}\nrender() {\nreturn (\n"},{"type":"element","tagName":"rect","properties":{"x":"{10}","y":"{10}","width":"{50}","height":"{50}","fill":"{this.state.color}","shadowblur":"{10}","onclick":"{this.handleClick}"},"children":[{"type":"text","value":"\n);\n}\n}\nfunction App() {\nreturn (\n"},{"type":"element","tagName":"stage","properties":{"width":"{700}","height":"{700}"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"layer","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"myrect","properties":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n);\n}\nReactDOM.render("},{"type":"element","tagName":"app","properties":{},"children":[{"type":"text","value":", document.getElementById(‘container’));\nDemo: "},{"type":"element","tagName":"a","properties":{"href":"http://jsbin.com/camene/8/edit?html,js,output"},"children":[{"type":"text","value":"http://jsbin.com/camene/8/edit?html,js,output"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Thanks "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/reactjs/react-art"},"children":[{"type":"text","value":"https://github.com/reactjs/react-art"}]},{"type":"text","value":" for providing good examples of custom React components."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Comparisons\nreact-konva vs react-canvas\nreact-canvas is a completely different react plugin. It allows you to draw DOM-like objects (images, texts) on canvas element in very performant way. It is NOT about drawing graphics, but react-konva is exactly for drawing complex graphics on "},{"type":"element","tagName":"canvas","properties":{},"children":[{"type":"text","value":" element from React."}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"react-konva vs react-art\nreact-art allows you to draw graphics on a page. It also supports SVG for output. But it has no support of events of shapes."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"react-konva vs vanilla canvas\nPerformance is one of the main buzz word in react hype."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"I made this plugin not for performance reasons. Using vanilla "},{"type":"element","tagName":"canvas","properties":{},"children":[{"type":"text","value":" should be more performant because while using react-konva you have Konva framework on top of "},{"type":"element","tagName":"canvas","properties":{},"children":[{"type":"text","value":" and React on top of Konva. But I made this plugin to fight with application complexity. Konva helps here a lot (especially when you need events for objects on canvas, like “click” on shape, it is really hard to do with vanilla canvas). But React helps here much more as it provides very good structure for your codebase and data flow."}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Features"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"react-konva logo\nreact-konva works on top of Konva so it has support for all core shapes: Circle, Rect, Ellipse, Line, Sprite, Image, Text, TextPath, Star, Ring, Arc, Label, SVG Path, RegularPolygon, Arrow and you can create your own custom shapes. Also you can use build in drag&drop support, tweening, animations, filters, caching system, desktop and mobile events (mouseenter, click, dblclick, dragstart, dragmove, dragend, tap, dbltap, etc) and much more."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Custom shape example\n// custom shape example\nfunction MyShape() {\nreturn (\n<Shape fill=”#00D2FF” draggable\nsceneFunc={function (ctx) {\nctx.beginPath();\nctx.moveTo(20, 50);\nctx.lineTo(220, 80);\nctx.quadraticCurveTo(150, 100, 260, 170);\nctx.closePath();\n// Konva specific method\nctx.fillStrokeShape(this);\n}}\n/>\n);\n}\nDemo: "},{"type":"element","tagName":"a","properties":{"href":"http://jsbin.com/gakadi/4/edit?html,js,output"},"children":[{"type":"text","value":"http://jsbin.com/gakadi/4/edit?html,js,output"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Events example\nclass MyCircle extends React.Component {\nconstructor(…args) {\nsuper(…args);\nthis.state = { isMouseInside: false};\nthis.handleMouseEnter = this.handleMouseEnter.bind(this);\nthis.handleMouseLeave = this.handleMouseLeave.bind(this);\n}\nhandleMouseEnter() {\nthis.setState({ isMouseInside: true});\n}\nhandleMouseLeave() {\nthis.setState({ isMouseInside: false});\n}\nrender() {\nreturn (\n<Circle\nx={100} y={60} radius={50}\nfill=”yellow” stroke=”black”\nstrokeWidth={this.state.isMouseInside ? 5 : 1}\nonMouseEnter={this.handleMouseEnter}\nonMouseLeave={this.handleMouseLeave}\n/>\n);\n}\n}\nDemo: "},{"type":"element","tagName":"a","properties":{"href":"http://jsbin.com/tekopu/3/edit?js,output"},"children":[{"type":"text","value":"http://jsbin.com/tekopu/3/edit?js,output"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Links\nGithub repo: "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/lavrton/react-konva"},"children":[{"type":"text","value":"https://github.com/lavrton/react-konva"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Konva framework: "},{"type":"element","tagName":"a","properties":{"href":"http://konvajs.github.io/"},"children":[{"type":"text","value":"http://konvajs.github.io/"}]}]}],"data":{"quirksMode":false}},"excerpt":"How to use React with canvas element? We have React that helps us to work with massive mutable DOM in a nice immutable functional style…","timeToRead":4,"frontmatter":{"title":"Using React With Canvas Element","userDate":"1 February 2016","date":"2016-02-01","tags":["react","canvas"],"image":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAABXUlEQVQY002Qb0vCUBTG9yn7GL3qXV+g6KWEUWEhFFJSBmbDWioZBWbpctps6pw425/772xrClEdjajnXi4PD9yHc34SZTSA0LJfWkYFIGSccs4Fnl8FEA3HneFYAxGib/eqDf0SDWNM8okrOOD1icMFC4J3IQRjBFtAAL4+dedlgqOfxV/l+p5ST0yjT+yVgEeEev1RM51fKT3sj2wD2LTWKuiDGohY7VY04waHc5w3z3N9jzR1Re0W8efENaWdwtKdmrFs7Sx/lEiubaU2NrfXlZL8+FQfDPpF5VyW5Ww2m8vlCucXu6nk8cmh2XM6ZjlTWpZOq6vVxkEcfcTRDKdwXPtezVabaSFgsTiQuXxKCaXUX4hzRog3cUcSRtZYtyZtrXeNGAAgCmPKCG7+A0zMhXEAsLCCh8G0ZZR181ZinEXBbGi3n1+vFgwpJvwfbfSU+QgF8f4l1CfM+wZeJ295EnDmUQAAAABJRU5ErkJggg==","aspectRatio":2.76056338028169,"src":"/static/react-canvas-28add40b9362347ac86350dac673b3a5-45564.png","srcSet":"/static/react-canvas-28add40b9362347ac86350dac673b3a5-b78fc.png 930w,\n/static/react-canvas-28add40b9362347ac86350dac673b3a5-45564.png 1372w","sizes":"(max-width: 1372px) 100vw, 1372px"}}},"author":{"id":"Ghost","bio":"The professional publishing platform","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAABMUlEQVQ4y2MwsXf5T03MMGogGBvbOYNpUwdXOIbJwdgwNQQNhCk0snX6r2thC8Y6QGxg7QCWA/FBcrgMxepCkAZrV6//EYmpYBydkvHfMzjiv5mj2//whJT/Nm7ecEMJGgjykp6V/f+AqLj/O/Ye+L8diA8dO/m/pbv/v72n3/+tu/f9D45N/K9naYcSFESFoRXQlSCX2rh7g/kgr1u5epIWhiAMCi/3wLD/fVNn/u+fNgtMT5g+6//kmXOB/Jn/PYLCwWrINnDijDlAPBvKJ8NAZC+DIgCkGYRBbJAYSV5GjpTte/b/PwiMkLj0nP8xqVn/Dxw9AY6kwOh40iIFlmzCgUkmKjnjvx0wdu08fMFskJi1mxfxyQY9YetAEzJyQic5YaNnPeTgIDnrjZaHJGMACtTMXoVAJ6sAAAAASUVORK5CYII=","width":400,"height":400,"src":"/static/ghost-5f2c129e42248a92c87b13b4293950cf-fba88.png","srcSet":"/static/ghost-5f2c129e42248a92c87b13b4293950cf-fba88.png 1x"}}]}}}},"relatedPosts":{"totalCount":1,"edges":[{"node":{"id":"bb80baff-bbd9-5d91-9166-1c5cca0d1532","timeToRead":4,"excerpt":"How to use React with canvas element? We have React that helps us to work with massive mutable DOM in a nice immutable functional style…","frontmatter":{"title":"Using React With Canvas Element"},"fields":{"slug":"/using-react-with-canvas-element/"}}}]}},"pageContext":{"slug":"/using-react-with-canvas-element/","prev":{"excerpt":"As I engage in the so-called “bull sessions” around and about the school, I too often find that most college men have a misconception of the…","timeToRead":2,"frontmatter":{"title":"The Purpose of Education","tags":["Speeches"],"date":"2012-08-20T15:11:55.000Z","image":{"childImageSharp":{"fluid":{"aspectRatio":1.5005359056806002,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABYBAQEBAAAAAAAAAAAAAAAAAAIAAf/aAAwDAQACEAMQAAAB1RGOUy//xAAcEAACAgIDAAAAAAAAAAAAAAABAwACBBETFCP/2gAIAQEAAQUCGRtdcidoRa68ISBZg9P/xAAVEQEBAAAAAAAAAAAAAAAAAAAQIf/aAAgBAwEBPwGH/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8BV//EABoQAAIDAQEAAAAAAAAAAAAAAAABAhEhUXH/2gAIAQEABj8C6zUbZBF2yXp//8QAGxABAAICAwAAAAAAAAAAAAAAAQARIUFRYXH/2gAIAQEAAT8hplEnLqXcXUztw+RCDV3M/hoZUZH/2gAMAwEAAgADAAAAEP8Az//EABcRAQEBAQAAAAAAAAAAAAAAAAEAESH/2gAIAQMBAT8QWYPb/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAgEBPxAG2cv/xAAeEAEAAgIBBQAAAAAAAAAAAAABABEhMUFxgbHR8P/aAAgBAQABPxCuOjpGfPFQ2l4bsuPmLgTUo16xwTxmkW/cHCiyNd+YThAU/9k=","sizes":"(max-width: 1400px) 100vw, 1400px","src":"/static/demo4-0a5c2fef6452a3ea59c927e685ed4fae-f759c.jpg","srcSet":"/static/demo4-0a5c2fef6452a3ea59c927e685ed4fae-2ff39.jpg 930w,\n/static/demo4-0a5c2fef6452a3ea59c927e685ed4fae-f759c.jpg 1400w"}}},"author":{"id":"Ghost","bio":"The professional publishing platform","avatar":{"children":[{"fixed":{"src":"/static/ghost-5f2c129e42248a92c87b13b4293950cf-fba88.png"}}]}}},"fields":{"layout":"post","slug":"/purpose-of-education/"}},"next":{"excerpt":"Ghost uses a language called  Markdown  to format text. When you go to edit a post and see special characters and colours intertwined…","timeToRead":3,"frontmatter":{"title":"Using The Ghost Editor","tags":["Getting Started"],"date":"2015-02-02T23:46:37.121Z","image":{"childImageSharp":{"fluid":{"aspectRatio":1.4973262032085561,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQBA//EABYBAQEBAAAAAAAAAAAAAAAAAAIAAf/aAAwDAQACEAMQAAABqbzKjVrP/8QAGBABAQEBAQAAAAAAAAAAAAAAAQIAAxH/2gAIAQEAAQUCLgb5y54x6AYfcrv/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAaEAACAgMAAAAAAAAAAAAAAAAAARARITJC/9oACAEBAAY/AqSNTowkXH//xAAaEAEAAgMBAAAAAAAAAAAAAAABACERMWGB/9oACAEBAAE/ISITNSzs8m8RyB0vI6VM6mf/2gAMAwEAAgADAAAAEGv/AP/EABcRAAMBAAAAAAAAAAAAAAAAAAABESH/2gAIAQMBAT8QekR//8QAFxEBAAMAAAAAAAAAAAAAAAAAAAERMf/aAAgBAgEBPxDFy//EAB8QAQACAgAHAAAAAAAAAAAAAAEAESExUWFxgZGhwf/aAAgBAQABPxBz7mbFOsuV4Bl9Z93yAa3kJXdwAvHuC1BNT//Z","sizes":"(max-width: 1400px) 100vw, 1400px","src":"/static/writing-8e92507f0141c508e4d5a30d3ca6fe53-f759c.jpg","srcSet":"/static/writing-8e92507f0141c508e4d5a30d3ca6fe53-2ff39.jpg 930w,\n/static/writing-8e92507f0141c508e4d5a30d3ca6fe53-f759c.jpg 1400w"}}},"author":{"id":"Ghost","bio":"The professional publishing platform","avatar":{"children":[{"fixed":{"src":"/static/ghost-5f2c129e42248a92c87b13b4293950cf-fba88.png"}}]}}},"fields":{"layout":"post","slug":"/using-the-ghost-editor/"}},"primaryTag":"react"}}